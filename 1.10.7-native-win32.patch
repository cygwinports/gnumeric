--- origsrc/gnumeric-1.10.7/configure.in	2010-06-30 23:27:07.727116900 -0500
+++ src/gnumeric-1.10.7/configure.in	2010-06-30 19:18:55.000000000 -0500
@@ -185,6 +185,18 @@ mingw* | pw32* | cygwin*)
     ;;
 esac
 
+with_native_win32=no
+case $host_os in
+mingw* | pw32*)
+    with_native_win32=yes
+    AC_ARG_VAR(WINDRES, [The windres executable (used by win32 builds only).])
+    AC_CHECK_TOOL(WINDRES, windres, :)
+    ;;
+esac
+AM_CONDITIONAL(WITH_WIN32, test $with_win32 = yes)
+AM_CONDITIONAL(WITH_NATIVE_WIN32, test $with_native_win32 = yes)
+
+
 dnl *******************
 dnl Should we use gtk ?
 dnl *******************
@@ -208,7 +220,7 @@ if test "x$gnumeric_with_gtk" = xtrue ;
 fi
 
 gnumeric_with_gnome=false
-if test "x$gnumeric_with_gtk" = xtrue -a "x$with_win32" = xno ; then
+if test "x$gnumeric_with_gtk" = xtrue -a "x$with_native_win32" = xno ; then
 	dnl ************************************
 	dnl Are the GNOME extensions available ?
 	dnl ************************************
@@ -252,16 +264,6 @@ PKG_CHECK_MODULES(GNUMERIC, $gnumeric_re
 AC_SUBST(GNUMERIC_LIBS)
 AC_SUBST(GNUMERIC_CFLAGS)
 
-with_native_win32=no
-case $host_os in
-mingw* | pw32*)
-    with_native_win32=yes
-    AC_ARG_VAR(WINDRES, [The windres executable (used by win32 builds only).])
-    AC_CHECK_TOOL(WINDRES, windres, :)
-    ;;
-esac
-AM_CONDITIONAL(WITH_WIN32, test $with_win32 = yes)
-AM_CONDITIONAL(WITH_NATIVE_WIN32, test $with_native_win32 = yes)
 AM_CONDITIONAL(CROSS_COMPILING, test x"$cross_compiling" != xno)
 
 if test "x$with_win32" = "xyes"; then
--- origsrc/gnumeric-1.10.7/doc/C/Makefile.am	2010-06-04 22:49:20.000000000 -0500
+++ src/gnumeric-1.10.7/doc/C/Makefile.am	2010-06-30 22:48:49.198648600 -0500
@@ -91,7 +91,7 @@ endif
 
 winhelp_DATA =
 winhelpdir=$(gnumeric_datadir)/$(subdir)
-if WITH_WIN32
+if WITH_NATIVE_WIN32
 winhelp_DATA += gnumeric.chm gnumeric.hhmap
 
 gnumeric.hhmap: chm-stamp
--- origsrc/gnumeric-1.10.7/doc/gnumeric-doc.make	2010-06-04 22:42:43.000000000 -0500
+++ src/gnumeric-1.10.7/doc/gnumeric-doc.make	2010-06-30 22:51:36.220201700 -0500
@@ -6,7 +6,7 @@
 # Requires that the calling makefile define 'lang'
 
 docname = gnumeric
-if !WITH_WIN32
+if !WITH_NATIVE_WIN32
   omffile = gnumeric-$(lang).omf
 endif
 gnumeric_docdir  = $(top_srcdir)/doc
--- origsrc/gnumeric-1.10.7/icons/Makefile.am	2010-06-14 19:50:13.000000000 -0500
+++ src/gnumeric-1.10.7/icons/Makefile.am	2010-06-30 22:52:01.116625700 -0500
@@ -24,7 +24,7 @@ EXTRA_DIST = $(icons_DATA) $(mimeicon_DA
 gtk_update_icon_cache = gtk-update-icon-cache -f -t $(datadir)/icons/hicolor
 
 fake_index_theme_target =
-if WITH_WIN32
+if WITH_NATIVE_WIN32
 fake_index_theme_target += install-fake-index-theme
 
 install-fake-index-theme: fake-index-theme
--- origsrc/gnumeric-1.10.7/src/Makefile.am	2010-06-30 23:27:07.743117800 -0500
+++ src/gnumeric-1.10.7/src/Makefile.am	2010-06-30 19:18:55.000000000 -0500
@@ -368,12 +368,12 @@ if WITH_NATIVE_WIN32
     ssconvert_LDFLAGS	+= -mconsole -Wl,--stack,0x4000000
     ssindex_LDFLAGS	+= -mconsole
     ssgrep_LDFLAGS	+= -mconsole
+endif
 
+if WITH_WIN32
     libspreadsheet_la_DEPENDENCIES = libspreadsheet.def
     libspreadsheet_la_LDFLAGS += -no-undefined -export-symbols libspreadsheet.def
-endif
 
-if WITH_WIN32
 libspreadsheet.def: local.def 
 	echo EXPORTS > $@ && \
 	cat $^ | sort >> $@
--- origsrc/gnumeric-1.10.7/tools/win32/Makefile.am	2010-04-13 20:07:08.000000000 -0500
+++ src/gnumeric-1.10.7/tools/win32/Makefile.am	2010-06-30 22:52:31.678373700 -0500
@@ -15,7 +15,7 @@ EXTRA_DIST = gnumeric.nsi.in gtkrc modul
 	build jhbuildrc.py
 
 
-if WITH_WIN32
+if WITH_NATIVE_WIN32
 install-data-hook:
 	install gnumeric.nsi ${prefix}
 
